use std::mem;

use hudhook::tracing::info;
use imgui::sys::{igGetCursorPosX, igGetCursorPosY, igGetWindowPos, igSetNextWindowPos, ImVec2};
use imgui::{Condition, InputText, WindowFlags};
use libeldenring::prelude::*;

use super::{scaling_factor, string_match, Widget, BUTTON_HEIGHT, BUTTON_WIDTH};
use crate::util::KeyState;

type WarpFunc = extern "system" fn(u64, u64, u32);

const POPUP_TAG: &str = "##warp";

#[derive(Debug)]
pub(crate) struct Warp {
    label: String,
    label_close: String,
    hotkey_close: KeyState,
    warp_ptr: usize,
    arg1: PointerChain<u64>,
    arg2: PointerChain<u64>,
    current_grace: usize,
    filter_string: String,
    filter_list: [bool; GRACES.len()],
}

impl Warp {
    pub(crate) fn new(
        warp_ptr: usize,
        arg1: PointerChain<u64>,
        arg2: PointerChain<u64>,
        hotkey_close: KeyState,
    ) -> Self {
        let label_close = format!("关闭 ({hotkey_close})");
        Warp {
            label: "传动到赐福点".to_string(),
            label_close,
            hotkey_close,
            warp_ptr,
            arg1,
            arg2,
            current_grace: 0,
            filter_string: String::new(),
            filter_list: [true; GRACES.len()],
        }
    }

    fn warp(&mut self) {
        let warp_fn: WarpFunc = unsafe { mem::transmute(self.warp_ptr) };
        let arg1 = self.arg1.read();
        let arg2 = self.arg2.read();

        info!("{:?} {:?}", arg1, arg2);

        if let (Some(arg1), Some(arg2)) = (arg1, arg2) {
            warp_fn(arg1, arg2, GRACES[self.current_grace].1 - 0x3e8);
        }
    }
}

impl Widget for Warp {
    fn render(&mut self, ui: &imgui::Ui) {
        let scale = scaling_factor(ui);
        let button_width = BUTTON_WIDTH * scale;

        let (x, y) = unsafe {
            let mut wnd_pos = ImVec2::default();
            igGetWindowPos(&mut wnd_pos);
            (igGetCursorPosX() + wnd_pos.x, igGetCursorPosY() + wnd_pos.y)
        };

        if ui.button_with_size(&self.label, [button_width, BUTTON_HEIGHT]) {
            ui.open_popup(POPUP_TAG);
        }

        unsafe {
            igSetNextWindowPos(
                ImVec2::new(x + 200. * scale, y),
                Condition::Always as i8 as _,
                ImVec2::new(0., 0.),
            )
        };
        if let Some(_token) = ui
            .modal_popup_config(POPUP_TAG)
            .flags(
                WindowFlags::NO_TITLE_BAR
                    | WindowFlags::NO_RESIZE
                    | WindowFlags::NO_MOVE
                    | WindowFlags::NO_SCROLLBAR
                    | WindowFlags::ALWAYS_AUTO_RESIZE,
            )
            .begin_popup()
        {
            let _tok = ui.push_item_width(-1.);

            if InputText::new(ui, "##warp-filter", &mut self.filter_string)
                .hint("过滤器...")
                .build()
            {
                GRACES.iter().enumerate().for_each(|(idx, (grace, _))| {
                    self.filter_list[idx] =
                        self.filter_string.is_empty() || string_match(&self.filter_string, grace)
                });

                if !self.filter_list[self.current_grace] {
                    self.current_grace = self.filter_list.iter().position(|f| *f).unwrap_or(0);
                }
            }

            let _tok = ui.push_item_width(-1.);
            if let Some(_combo) = ui.begin_combo_with_flags("##warp-graces", GRACES[self.current_grace].0, imgui::ComboBoxFlags::HEIGHT_LARGE) {
                for (idx, (grace, _)) in
                    GRACES.iter().enumerate().filter(|(idx, _)| self.filter_list[*idx])
                {
                    let selected = idx == self.current_grace;
                    if selected {
                        ui.set_item_default_focus();
                    }

                    if ui.selectable_config(grace).selected(selected).build() {
                        self.current_grace = idx;
                    }
                }
            }

            let _tok = ui.push_item_width(-1.);
            if ui.button_with_size("传送", [400., BUTTON_HEIGHT]) {
                self.warp();
            }

            let _tok = ui.push_item_width(-1.);
            if ui.button_with_size(&self.label_close, [400., BUTTON_HEIGHT])
                || (self.hotkey_close.keyup(ui) && !ui.is_any_item_active())
            {
                ui.close_current_popup();
            }
        }
    }
}

const GRACES: &[(&str, u32)] = &[
/*
    ("Abandoned Cave", 31202950),
    ("Abandoned Coffin", 1037512950),
    ("Abductor Virgin", 16002962),
    ("Academy Crystal Cave", 31062950),
    ("Academy Gate Town", 1037442950),
    ("Across the Roots", 12032955),
    ("Aeonia Swamp Shore", 1048382950),
    ("Agheel Lake North", 1043372950),
    ("Agheel Lake South", 1044352950),
    ("Ailing Village Outskirts", 1044332952),
    ("Ainsel River Downstream", 12012953),
    ("Ainsel River Main", 12012954),
    ("Ainsel River Sluice Gate", 12012952),
    ("Ainsel River Well Depths", 12012951),
    ("Altar South", 1033402950),
    ("Altus Highway Junction", 1039512950),
    ("Altus Plateau", 1038502952),
    ("Altus Tunnel", 32052950),
    ("Ancestral Woods", 12022956),
    ("Ancient Snow Valley Ruins", 1051562950),
    ("Apostate Derelict", 1047582950),
    ("Aqueduct-Facing Cliffs", 12022957),
    ("Artist's Shack", 1038452950),
    ("Artist's Shack", 1044382950),
    ("Astel, Naturalborn of the Void", 12042950),
    ("Astray from Caelid Highway North", 1048382951),
    ("Audience Pathway", 16002960),
    ("Auzira Hero's Grave", 30102950),
    ("Auriza Side Tomb", 30132950),
    ("Avenue Balcony", 11002954),
    ("Behind Caria Manor", 1036502950),
    ("Behind The Castle", 1043312951),
    ("Bellum Church", 1036492950),
    ("Below the Well", 12022959),
    ("Beside the Crater-Pocked Glade", 1045332950),
    ("Beside the Great Bridge", 13002960),
    ("Beside the Rampart Gaol", 1043312952),
    ("Bestial Sanctum", 1051432950),
    ("Black Knife Catacombs", 30052950),
    ("Boilprawn Shack", 1036432950),
    ("Bower of Bounty", 1040532950),
    ("Bridge of Iniquity", 1039532950),
    ("Bridge of Sacrifice", 1044342950),
    ("Caelem Ruins", 1047402950),
    ("Caelid Catacombs", 30152950),
    ("Caelid Highway South", 1048372950),
    ("Capital Rampart", 1045522950),
    ("Castellan's Hall", 1039542952),
    ("Castle Morne Lift", 1043312950),
    ("Castle Morne Rampart", 1044332950),
    ("Castle Sol Main Gate", 1051572951),
    ("Castle Sol Rooftop", 1051572953),
    ("Castleward Tunnel", 10002952),
    ("Cathedral of Dragon Communion", 1048362950),
    ("Cathedral of Manus Celes", 1035422950),
    ("Cathedral of the Forsaken", 35002950),
    ("Cave of Knowledge", 18002950),
    ("Cave of the Forlorn", 31122950),
    ("Chair-Crypt of Sellia", 1049392951),
    ("Chamber Outside the Plaza", 1051362951),
    ("Chapel of Anticipation (New Game)", 10012020),
    ("Church of Dragon Communion", 1041352950),
    ("Church of Elleh", 1042362950),
    ("Church of Inhibition", 1037492950),
    ("Church of Pilgrimage", 1043342950),
    ("Church of Repose", 1051532950),
    ("Church of Vows", 1037462950),
    ("Church of the Cuckoo", 14002952),
    ("Church of the Eclipse", 1051572952),
    ("Church of the Plague", 1050382950),
    ("Cliffbottom Catacombs", 30062950),
    ("Coastal Cave", 31152950),
    ("Cocoon of the Empyrean", 12052950),
    ("Consecrated Snowfield", 1049542950),
    ("Consecrated Snowfield Catacombs", 30192950),
    ("Converted Tower", 1034432950),
    ("Craftsman's Shack", 1036522950),
    ("Crumbling Beast Grave", 13002953),
    ("Crumbling Beast Grave Depths", 13002954),
    ("Crystalline Woods", 1034462950),
    ("Deathtouched Catacombs", 30112950),
    ("Debate Parlour", 14002951),
    ("Deep Siofra Well", 1048402950),
    ("Deeproot Depths", 12032953),
    ("Divine Bridge", 11002959),
    ("Divine Bridge", 11052955),
    ("Divine Tower of Caelid: Basement", 34132951),
    ("Divine Tower of Caelid: Center", 34132952),
    ("Divine Tower of East Altus", 34142951),
    ("Divine Tower of East Altus: Gate", 34142950),
    ("Divine Tower of Limgrave", 34102952),
    ("Divine Tower of Liurnia", 34112952),
    ("Divine Tower of West Altus", 34122950),
    ("Divine Tower of West Altus: Gate", 34122952),
    ("Dragon Temple", 13002956),
    ("Dragon Temple Altar", 13002952),
    ("Dragon Temple Lift", 13002958),
    ("Dragon Temple Rooftop", 13002959),
    ("Dragon Temple Transept", 13002957),
    ("Dragonbarrow Cave", 31102950),
    ("Dragonbarrow Fork", 1050402950),
    ("Dragonbarrow West", 1048402951),
    ("Dragonkin Soldier of Nokstella", 12012950),
    ("Dragonlord Placidusax", 13002951),
    ("Drainage Channel", 15002953),
    ("Dynasty Mausoleum Entrance", 12052952),
    ("Dynasty Mausoleum Midpoint", 12052953),
    ("Earthbore Cave", 31012950),
    ("East Capital Rampart", 11002952),
    ("East Capital Rampart", 11052952),
    ("East Gate Bridge Trestle", 1035472950),
    ("East Raya Lucaria Gate", 1036482950),
    ("Eastern Liurnia Lake Shore", 1038452951),
    ("Eastern Tableland", 1038462950),
    ("Elden Throne", 11002950),
    ("Elden Throne", 11052950),
    ("Elphael Inner Wall", 15002952),
    ("Erdtree Sanctuary", 11002951),
    ("Erdtree Sanctuary", 11052951),
    ("Erdtree-Gazing Hill", 1038512950),
    ("Fallen Ruins of the Lake", 1036432951),
    ("Farum Greatbridge", 1052422950),
    ("Fire Giant", 1053522950),
    ("First Church of Marika", 1054552950),
    ("First Mt. Gelmir Campsite", 1038542950),
    ("Folly on the Lake", 1035432950),
    ("Foot of the Forge", 1052532950),
    ("Foot of the Four Belfries", 1033462950),
    ("Forbidden Lands", 1047512950),
    ("Forest-Spanning Greatbridge", 1040522950),
    ("Forge of the Giants", 1054532950),
    ("Forsaken Depths", 35002952),
    ("Fort Faroth", 1051392950),
    ("Fort Gael North", 1047392950),
    ("Fort Haight West", 1045362950),
    ("Fortified Manor, First Floor", 11002958),
    ("Fourth Church of Marika", 1041332950),
    ("Fractured Marika", 19002950),
    ("Freezing Lake", 1052572950),
    ("Frenzied Flame Proscription", 35002954),
    ("Frenzied Flame Village Outskirts", 1038482950),
    ("Gael Tunnel", 32072950),
    ("Gaol Cave", 31212950),
    ("Gate Town Bridge", 1038432950),
    ("Gate Town North", 1036452950),
    ("Gatefront", 1042372950),
    ("Gateside Chamber", 10002953),
    ("Gelmir Hero's Grave", 30092950),
    ("Giant's Gravepost", 1052542950),
    ("Giant's Mountaintop Catacombs", 30182950),
    ("Giant-Conquering Hero's Grave", 30172950),
    ("Godrick the Grafted", 10002950),
    ("Grand Cloister", 12012958),
    ("Grand Lift of Dectus", 1038502950),
    ("Grand Lift of Rold", 1049532951),
    ("Great Waterfall Basin", 12022950),
    ("Great Waterfall Crest", 12032952),
    ("Groveside Cave", 31032950),
    ("Guest Hall", 16002954),
    ("Haligtree Canopy", 15002956),
    ("Haligtree Promenade", 15002955),
    ("Haligtree Roots", 15002954),
    ("Haligtree Town", 15002957),
    ("Haligtree Town Plaza", 15002958),
    ("Heart of Aeonia", 1049382950),
    ("Hermit Merchant's Shack", 1043532950),
    ("Hidden Path to the Haligtree", 30202950),
    ("Highroad Cave", 31172950),
    ("Impaler's Catacombs", 30012950),
    ("Impassable Greatbridge", 1050362950),
    ("Inner Aeonia", 1049382951),
    ("Inner Consecrated Snowfield", 1049552950),
    ("Isolated Divine Tower", 34152950),
    ("Isolated Merchant's Shack", 1041322950),
    ("Isolated Merchant's Shack", 1048412950),
    ("Jarburg", 1039442950),
    ("Lake of Rot Shoreside", 12012956),
    ("Lake-Facing Cliffs", 1039402950),
    ("Lakeside Crystal Cave", 31052950),
    ("Laskyar Ruins", 1038412950),
    ("Lenne's Rise", 1052412950),
    ("Leyndell, Capital of Ash", 11052953),
    ("Leyndell Catacombs", 35002953),
    ("Liftside Chamber", 10002956),
    ("Limgrave Tower Bridge", 34102950),
    ("Limgrave Tunnels", 32012950),
    ("Liurnia Highway North", 1039422950),
    ("Liurnia Highway South", 1039412950),
    ("Liurnia Lake Shore", 1038402950),
    ("Liurnia Tower Bridge", 34112951),
    ("Lower Capital Church", 11002953),
    ("Magma Wyrm", 39202950),
    ("Main Academy Gate", 1035462950),
    ("Main Caria Manor Gate", 1035502953),
    ("Malenia, Godess of Rot", 15002950),
    ("Maliketh, the Black Blade", 13002950),
    ("Manor Lower Level", 1035502951),
    ("Manor Upper Level", 1035502950),
    ("Margit, the Fell Omen", 10002951),
    ("Mausoleum Compound", 1037482950),
    ("Mimic Tear", 12022951),
    ("Minor Eerdtree Catacombs", 30142950),
    ("Minor Eerdtree Church", 1043502950),
    ("Mistwood Outskirts", 1044372950),
    ("Moonlight Altar", 1034412950),
    ("Morne Moangrave", 1043302950),
    ("Morne Tunnel", 32002950),
    ("Murkwater Catacombs", 30042950),
    ("Murkwater Cave", 31002950),
    ("Murkwater Coast", 1043382950),
    ("Night's Sacred Ground", 12022958),
    ("Ninth Mt. Gelmir Campsite", 1036542951),
    ("Nokron, Eternal City", 12072951),
    ("Nokstella Waterfall Basin", 12012959),
    ("Nokstella, Eternal City", 12012955),
    ("Northern Liurnia Lake Shore", 1034482950),
    ("Old Altus Tunnel", 32042950),
    ("Ordina, Liturgical Town", 1048572950),
    ("Outer Wall Battleground", 1043532951),
    ("Outer Wall Phantom Tree", 1042512950),
    ("Palace Approach Ledge-Road", 12052951),
    ("Perfumer's Grotto", 31182950),
    ("Prayer Room", 15002951),
    ("Primeval Sorcerer Azur", 1037532950),
    ("Prince of Death's Throne", 12032950),
    ("Prison Town Church", 16002953),
    ("Queen's Bedchamber", 11002957),
    ("Queen's Bedchamber", 11052954),
    ("Rampart Tower", 10002955),
    ("Rampartside Path", 1041522951),
    ("Ranni's Chamber", 1034502951),
    ("Ranni's Rise", 1034502950),
    ("Ravine-Veiled Village", 1038502951),
    ("Raya Lucaria Crystal Tunnel", 32022950),
    ("Raya Lucaria Grand Library", 14002950),
    ("Rear Gael Tunnel Entrance", 32072951),
    ("Redmane Castle Plaza", 1051362950),
    ("Revenger's Shack", 1033442950),
    ("Road of Iniquity", 1036542952),
    ("Road of Iniquity Side Path", 1040542950),
    ("Road to the Manor", 1034492950),
    ("Road's End Catacombs", 30032950),
    ("Root-Facing Cliffs", 12032951),
    ("Rotview Balcony", 1046402951),
    ("Royal Moongazing Grounds", 1035502952),
    ("Ruin-Strewn Precipice", 39202951),
    ("Ruin-Strewn Precipice Overlook", 39202952),
    ("Ruined Labyrinth", 1038472950),
    ("Rykard, Lord of Blasphemy", 16002950),
    ("Sage's Cave", 31192950),
    ("Sainted Hero's Grave", 30082950),
    ("Saintsbridge", 1043392950),
    ("Scenic Isle", 1037422950),
    ("Schoolhouse Classroom", 14002953),
    ("Sealed Tunnel", 34122951),
    ("Seaside Ruins", 1043352950),
    ("Secluded Cell", 10002957),
    ("Seethewater Cave", 31072950),
    ("Seethewater River", 1037522951),
    ("Seethewater Terminus", 1035532950),
    ("Sellia Backstreets", 1049392950),
    ("Sellia Crystal Tunnel", 32082950),
    ("Sellia Hideaway", 31112950),
    ("Sellia Under-Stair", 1049392952),
    ("Shaded Castle Inner Gate", 1039542951),
    ("Shaded Castle Ramparts", 1039542950),
    ("Siofra River Bank", 12022953),
    ("Siofra River Well Depths", 12072950),
    ("Slumbering Wolf Shack", 1036412950),
    ("Smoldering Church", 1046402950),
    ("Smoldering Wall", 1048392950),
    ("Snow Valley Ruins Overlook", 1051572950),
    ("Sorcerer's Isle", 1034472951),
    ("South Raya Lucaria Gate", 1035452950),
    ("South of the Lookout Tower", 1044332951),
    ("Southern Aeonia Swamp Bank", 1049372950),
    ("Spiritcaller's Cave", 31222950),
    ("Starscourge Radahn", 1052382950),
    ("Stillwater Cave", 31042950),
    ("Stormfoot Catacombs", 30022950),
    ("Stormhill Shack", 1041382950),
    ("Stormveil Cliffside", 10002954),
    ("Stormveil Main Gate", 10002958),
    ("Stranded Graveyard", 18002951),
    ("Study Hall Entrance", 34112950),
    ("Subterranean Inquisition Chamber", 16002964),
    ("Summonwater Village Outskirts", 1044392950),
    ("Table of Lost Grace", 11102950),
    ("Tempest-Facing Balcony", 13002955),
    ("Temple Quarter", 1034442950),
    ("Temple of Eiglay", 16002951),
    ("The First Step", 1042362951),
    ("The Four Belfries", 1033472950),
    ("The Nameless Eternal City", 12032954),
    ("The Ravine", 1036492951),
    ("Third Church of Marika", 1046382950),
    ("Tombsward", 1042332950),
    ("Tombsward Catacombs", 30002950),
    ("Tombsward Cave", 31022950),
    ("Underground Roadside", 35002951),
    ("Unsightly Catacombs", 30122950),
    ("Village of the Albinaurics", 1034422950),
    ("Volcano Cave", 31092950),
    ("Volcano Manor", 16002952),
    ("War-Dead Catacombs", 30162950),
    ("Warmaster's Shack", 1042382950),
    ("Waypoint Ruins Cellar", 1044362950),
    ("West Capital Rampart", 11002955),
    ("Whiteridge Road", 1052562950),
    ("Windmill Heights", 1042552950),
    ("Windmill Village", 1041542950),
    ("Worshippers' Woods", 12022954),
    ("Wyndham Catacombs", 30072950),
    ("Yelough Anix Tunnel", 32112950),
    ("Zamor Ruins", 1049532950),
*/
    ("[圆桌厅堂] 大赐福", 11102950),
    ("[史东薇尔城] 侯王礼拜堂 (新游戏)", 10012020),
    ("[漂流墓地] 求学洞窟", 18002950),
    ("[漂流墓地] 漂流墓地", 18002951),
    ("[宁姆格福] 龙飨教堂", 1041352950),
    ("[宁姆格福] 风暴山丘的破屋", 1041382950),
    ("[宁姆格福] 艾雷教堂", 1042362950),
    ("[宁姆格福] 引导之始", 1042362951),
    ("[宁姆格福] 关卡前废墟", 1042372950),
    ("[宁姆格福] 习战者的破屋", 1042382950),
    ("[宁姆格福] 傍海古遗迹", 1043352950),
    ("[宁姆格福] 亚基尔湖北方", 1043372950),
    ("[宁姆格福] 蒙流岸边", 1043382950),
    ("[宁姆格福] 圣人桥", 1043392950),
    ("[宁姆格福] 亚基尔湖南方", 1044352950),
    ("[宁姆格福] 驿站街遗迹的地下室", 1044362950),
    ("[宁姆格福] 雾林边缘", 1044372950),
    ("[宁姆格福] 画家的破屋", 1044382950),
    ("[宁姆格福] 水唤村外", 1044392950),
    ("[宁姆格福] 海德要塞西方", 1045362950),
    ("[宁姆格福] 玛莉卡第三教堂", 1046382950),
    ("[宁姆格福] 宁姆格福神授塔（桥上）", 34102950),
    ("[宁姆格福] 宁姆格福神授塔", 34102952),
    ("[宁姆格福] 宁姆格福坑道", 32012950),
    ("[宁姆格福] 近林洞窟", 31032950),
    ("[宁姆格福] 蒙流洞窟", 31002950),
    ("[宁姆格福] 海岸洞窟", 31152950),
    ("[宁姆格福] 大道下的洞窟", 31172950),
    ("[宁姆格福] 死亡降临的地下墓地", 30112950),
    ("[宁姆格福] 风暴根脚的地下墓地", 30022950),
    ("[宁姆格福] 蒙流地下墓地", 30042950),
    ("[史东薇尔城] 通城隧道", 10002952),
    ("[史东薇尔城] “恶兆妖鬼”玛尔基特", 10002951),
    ("[史东薇尔城] 史东薇尔正门", 10002958),
    ("[史东薇尔城] 史东薇尔断崖", 10002954),
    ("[史东薇尔城] 门旁小屋", 10002953),
    ("[史东薇尔城] 城墙塔", 10002955),
    ("[史东薇尔城] 升降机旁房间", 10002956),
    ("[史东薇尔城] 深处小房间", 10002957),
    ("[史东薇尔城] “接肢”葛瑞克", 10002950),
    ("[啜泣半岛] 地坑旁", 1045332950),
    ("[啜泣半岛] 摩恩城（城墙前方）", 1044332950),
    ("[啜泣半岛] 监视塔的南方", 1044332951),
    ("[啜泣半岛] 献祭大桥", 1044342950),
    ("[啜泣半岛] 病村", 1044332952),
    ("[啜泣半岛] 巡礼教堂", 1043342950),
    ("[啜泣半岛] 玛莉卡第四教堂", 1041332950),
    ("[啜泣半岛] 灵庙原野", 1042332950),
    ("[啜泣半岛] 隐居商人的破屋", 1041322950),
    ("[啜泣半岛] 摩恩城", 1043312950),
    ("[啜泣半岛] 城堡后方", 1043312951),
    ("[啜泣半岛] 城墙监牢旁", 1043312952),
    ("[啜泣半岛] 摩恩悲叹墓", 1043302950),
    ("[啜泣半岛] 摩恩坑道", 32002950),
    ("[啜泣半岛] 垂穴洞窟", 31012950),
    ("[啜泣半岛] 灵庙原野洞窟", 31022950),
    ("[啜泣半岛] 灵庙原野地下墓地", 30002950),
    ("[啜泣半岛] 穿刺地下墓地", 30012950),
    ("[湖之利耶尼亚] 傍湖断崖", 1039402950),
    ("[湖之利耶尼亚] 利耶尼亚大道（南方）", 1039412950),
    ("[湖之利耶尼亚] 利耶尼亚大道（北方）", 1039422950),
    ("[湖之利耶尼亚] 门前镇大桥", 1038432950),
    ("[湖之利耶尼亚] 壶村", 1039442950),
    ("[湖之利耶尼亚] 书斋入口", 34112950),
    ("[湖之利耶尼亚] 利耶尼亚神授塔（桥上）", 34112951),
    ("[湖之利耶尼亚] 利耶尼亚神授塔", 34112952),
    ("[湖之利耶尼亚] 拉斯卡废墟", 1038412950),
    ("[湖之利耶尼亚] 眠狼的破屋", 1036412950),
    ("[湖之利耶尼亚] 远眺岛", 1037422950),
    ("[湖之利耶尼亚] 煮虾子的破屋", 1036432950),
    ("[湖之利耶尼亚] 湖中坠落遗迹", 1036432951),
    ("[湖之利耶尼亚] 湖畔凉亭", 1035432950),
    ("[湖之利耶尼亚] 白金村", 1034422950),
    ("[湖之利耶尼亚] 教堂区", 1034442950),
    ("[湖之利耶尼亚] 改宗塔", 1034432950),
    ("[湖之利耶尼亚] 复仇者的破屋", 1033442950),
    ("[湖之利耶尼亚] 四钟楼山脚", 1033462950),
    ("[湖之利耶尼亚] 四钟楼", 1033472950),
    ("[湖之利耶尼亚] 结晶森林", 1034462950),
    ("[湖之利耶尼亚] 魔法师塔的小岛", 1034472951),
    ("[湖之利耶尼亚] 利耶尼亚湖（北岸）", 1034482950),
    ("[湖之利耶尼亚] 学院门前镇", 1037442950),
    ("[湖之利耶尼亚] 门前镇的北方", 1036452950),
    ("[湖之利耶尼亚] 学院正门口", 1035462950),
    ("[湖之利耶尼亚] 雷亚卢卡利亚（南门）", 1035452950),
    ("[湖之利耶尼亚] 雷亚卢卡利亚（东门）", 1036482950),
    ("[湖之利耶尼亚] 东门桥的桥柱", 1035472950),
    ("[湖之利耶尼亚] 利耶尼亚湖（湖边）", 1038402950),
    ("[湖之利耶尼亚] 利耶尼亚湖（东岸）", 1038452951),
    ("[湖之利耶尼亚] 画家的破屋", 1038452950),
    ("[湖之利耶尼亚] 东边台地", 1038462950),
    ("[湖之利耶尼亚] 结缘教堂", 1037462950),
    ("[湖之利耶尼亚] 遗迹迷宫", 1038472950),
    ("[湖之利耶尼亚] 群集灵庙", 1037482950),
    ("[湖之利耶尼亚] 通往城寨的道路", 1034492950),
    ("[湖之利耶尼亚] 卡利亚城寨（正门）", 1035502953),
    ("[湖之利耶尼亚] 城寨下部", 1035502951),
    ("[湖之利耶尼亚] 城寨上部", 1035502950),
    ("[湖之利耶尼亚] 王室赏月地", 1035502952),
    ("[湖之利耶尼亚] 卡利亚城寨（后方）", 1036502950),
    ("[湖之利耶尼亚] 菈妮魔法师塔", 1034502950),
    ("[湖之利耶尼亚] 菈妮的房间", 1034502951),
    ("[湖之利耶尼亚] 彼鲁姆教堂", 1036492950),
    ("[湖之利耶尼亚] 癫火村", 1038482950),
    ("[湖之利耶尼亚] 镇静教堂", 1037492950),
    ("[湖之利耶尼亚] 迪可达斯大升降机", 1038502950),
    ("[湖之利耶尼亚] 谷底", 1036492951),
    ("[湖之利耶尼亚] 谷底秘村", 1038502951),
    ("[湖之利耶尼亚] 古遗迹断崖", 39202951),
    ("[湖之利耶尼亚] 古遗迹断崖（对岸）", 39202952),
    ("[湖之利耶尼亚] “熔岩土龙”马卡尔", 39202950),
    ("[湖之利耶尼亚] 雷亚卢卡利亚结晶坑道", 32022950),
    ("[湖之利耶尼亚] 留水洞窟", 31042950),
    ("[湖之利耶尼亚] 湖旁结晶洞窟", 31052950),
    ("[湖之利耶尼亚] 学院结晶洞窟", 31062950),
    ("[湖之利耶尼亚] 绝路地下墓地", 30032950),
    ("[湖之利耶尼亚] 黑刀地下墓地", 30052950),
    ("[湖之利耶尼亚] 断崖下的地下墓地", 30062950),
    ("[魔法学院雷亚卢卡利亚] 杜鹃教堂", 14002952),
    ("[魔法学院雷亚卢卡利亚] 校舍内的教室", 14002953),
    ("[魔法学院雷亚卢卡利亚] 讨论室", 14002951),
    ("[魔法学院雷亚卢卡利亚] 雷亚卢卡利亚大书库", 14002950),
    ("[月光祭坛] 月光祭坛", 1034412950),
    ("[月光祭坛] 玛努斯·瑟利斯大教堂", 1035422950),
    ("[月光祭坛] 祭坛南方", 1033402950),
    ("[盖利德] 熏火教堂", 1046402950),
    ("[盖利德] 腐败旁露台", 1046402951),
    ("[盖利德] 盖尔要塞北方", 1047392950),
    ("[盖利德] 奇列姆废墟", 1047402950),
    ("[盖利德] 希芙拉河的出口井", 1048402950),
    ("[盖利德] 熏烧火墙", 1048392950),
    ("[盖利德] 盖利德大道北方（偏离大道后）", 1048382951),
    ("[盖利德] 盖利德大道南方", 1048372950),
    ("[盖利德] 大龙飨教堂", 1048362950),
    ("[盖利德] 艾奥尼亚沼泽（岸边）", 1048382950),
    ("[盖利德] 艾奥尼亚中心地", 1049382950),
    ("[盖利德] 艾奥尼亚沼泽（深处）", 1049382951),
    ("[盖利德] 艾奥尼亚沼泽（南岸）", 1049372950),
    ("[盖利德] 瑟利亚镇（楼梯下方）", 1049392952),
    ("[盖利德] 瑟利亚椅子庙", 1049392951),
    ("[盖利德] 瑟利亚镇后侧", 1049392950),
    ("[盖利德] 腐败病教堂", 1050382950),
    ("[盖利德] 不破大桥", 1050362950),
    ("[盖利德] 红狮子城（广场）", 1051362950),
    ("[盖利德] 广场前房间", 1051362951),
    ("[盖利德] “碎星”拉塔恩", 1052382950),
    ("[盖利德] 盖尔坑道", 32072950),
    ("[盖利德] 盖尔坑道（侧门口）", 32072951),
    ("[盖利德] 瑟利亚结晶坑道", 32082950),
    ("[盖利德] 废弃洞窟", 31202950),
    ("[盖利德] 牢狱洞窟", 31212950),
    ("[盖利德] 小黄金树地下墓地", 30142950),
    ("[盖利德] 盖利德地下墓地", 30152950),
    ("[盖利德] 英灵地下墓地", 30162950),
    ("[桂奥尔龙墓] 龙墓西方", 1048402951),
    ("[桂奥尔龙墓] 盖利德神授塔（地底）", 34132951),
    ("[桂奥尔龙墓] 盖利德神授塔（中段）", 34132952),
    ("[桂奥尔龙墓] 隐居商人的破屋", 1048412950),
    ("[桂奥尔龙墓] 龙墓的岔路", 1050402950),
    ("[桂奥尔龙墓] 法洛斯要塞", 1051392950),
    ("[桂奥尔龙墓] 雷恩魔法师塔", 1052412950),
    ("[桂奥尔龙墓] 法姆大桥", 1052422950),
    ("[桂奥尔龙墓] 野兽神殿", 1051432950),
    ("[桂奥尔龙墓] 孤立神授塔", 34152950),
    ("[桂奥尔龙墓] 龙墓洞窟", 31102950),
    ("[桂奥尔龙墓] 瑟利亚隐藏洞窟", 31112950),
    ("[希芙拉河] 希芙拉河（井底）", 12072950),
    ("[希芙拉河] 希芙拉河（岸边）", 12022953),
    ("[希芙拉河] 信仰者森林", 12022954),
    ("[希芙拉河] 出口井的下方", 12022959),
    ("[“永恒之城”诺克隆恩] “永恒之城”诺克隆恩", 12072951),
    ("[“永恒之城”诺克隆恩] 仿身泪滴", 12022951),
    ("[“永恒之城”诺克隆恩] 祖灵森林", 12022956),
    ("[“永恒之城”诺克隆恩] 导水桥旁断崖", 12022957),
    ("[“永恒之城”诺克隆恩] 黑夜神域", 12022958),
    ("[“永恒之城”诺克隆恩] 大瀑布水潭", 12022950),
    ("[深根底层] 大瀑布顶端", 12032952),
    ("[深根底层] 树根前路", 12032955),
    ("[深根底层] 树根旁断崖", 12032951),
    ("[深根底层] 深根底层", 12032953),
    ("[深根底层] 无名永恒之城", 12032954),
    ("[深根底层] 死王子宝座", 12032950),
    ("[安瑟尔河] 安瑟尔河（井底）", 12012951),
    ("[安瑟尔河] 安瑟尔河（水门）", 12012952),
    ("[安瑟尔河] 安瑟尔河（下游）", 12012953),
    ("[安瑟尔河] 诺克史黛拉的龙人士兵", 12012950),
    ("[安瑟尔河主流] 安瑟尔河主流", 12012954),
    ("[安瑟尔河主流] “永恒之城”诺克史黛拉", 12012955),
    ("[安瑟尔河主流] 诺克史黛拉水潭", 12012959),
    ("[腐败湖] 腐败湖畔", 12012956),
    ("[腐败湖] 大回廊", 12012958),
    ("[安瑟尔河] “黑暗弃子”艾丝缇", 12042950),
    ("[格密尔火山] 沸滚河", 1037522951),
    ("[格密尔火山] 沸滚河终点", 1035532950),
    ("[格密尔火山] 匠人的破屋", 1036522950),
    ("[格密尔火山] “起源魔法师”亚兹勒", 1037532950),
    ("[格密尔火山] 罪人桥", 1039532950),
    ("[格密尔火山] 格密尔火山（第９休息站）", 1036542951),
    ("[格密尔火山] 格密尔火山（第１休息站）", 1038542950),
    ("[格密尔火山] 移送罪人之路", 1036542952),
    ("[格密尔火山] 沸滚河洞窟", 31072950),
    ("[格密尔火山] 火山洞窟", 31092950),
    ("[格密尔火山] 威达姆地下墓地", 30072950),
    ("[格密尔火山] 格密尔英雄墓地", 30092950),
    ("[火山官邸] “亵渎君王”拉卡德", 16002950),
    ("[火山官邸] 艾格蕾教堂", 16002951),
    ("[火山官邸] 火山官邸", 16002952),
    ("[火山官邸] 牢镇教堂", 16002953),
    ("[火山官邸] 迎宾厅", 16002954),
    ("[火山官邸] 谒见之路", 16002960),
    ("[火山官邸] 掳人少女人偶", 16002962),
    ("[火山官邸] 地底拷问所", 16002964),
    ("[亚坛高原] 亚坛高原", 1038502952),
    ("[亚坛高原] 弃置棺材", 1037512950),
    ("[亚坛高原] 近黄金树的山丘", 1038512950),
    ("[亚坛高原] 亚坛大道的三叉口", 1039512950),
    ("[亚坛高原] 日荫城（城墙）", 1039542950),
    ("[亚坛高原] 日荫城（内门）", 1039542951),
    ("[亚坛高原] 城主大厅", 1039542952),
    ("[亚坛高原] 穿林大桥", 1040522950),
    ("[亚坛高原] 丰饶森林", 1040532950),
    ("[亚坛高原] 移送罪人之路（路旁）", 1040542950),
    ("[亚坛高原] 城墙旁小径", 1041522951),
    ("[亚坛高原] 风车村", 1041542950),
    ("[亚坛高原] 风车村高台", 1042552950),
    ("[亚坛高原] 旧亚坛坑道", 32042950),
    ("[亚坛高原] 亚坛坑道", 32052950),
    ("[亚坛高原] 调香师的隐藏洞窟", 31182950),
    ("[亚坛高原] 贤者的洞窟", 31192950),
    ("[亚坛高原] 尊贵者的英雄墓地", 30082950),
    ("[亚坛高原] 丑恶地下墓地", 30122950),
    ("[王城城墙外] 城外幻影树", 1042512950),
    ("[王城城墙外] 小黄金树教堂", 1043502950),
    ("[王城城墙外] 封印坑道", 34122951),
    ("[王城城墙外] 西亚坛神授塔", 34122950),
    ("[王城城墙外] 西亚坛神授塔（门口）", 34122952),
    ("[王城城墙外] 城外战场遗迹", 1043532951),
    ("[王城城墙外] 遁世商人的破屋", 1043532950),
    ("[王城城墙外] 王城城墙前方", 1045522950),
    ("[王城城墙外] 亚雷萨英雄墓地", 30102950),
    ("[王城城墙外] 亚雷萨副墓地", 30132950),
    ("[王城罗德尔] 王城东边城墙", 11002952),
    ("[王城罗德尔] 大道旁露台", 11002954),
    ("[王城罗德尔] 王城底层教堂", 11002953),
    ("[王城罗德尔] 王城西边城墙", 11002955),
    ("[王城罗德尔] 城寨一楼", 11002958),
    ("[王城罗德尔] 黄金树大教堂", 11002951),
    ("[王城罗德尔] 女王闺阁", 11002957),
    ("[王城罗德尔] 艾尔登宝座", 11002950),
    ("[王城罗德尔] 神授桥", 11002959),
    ("[弃置恶兆的地底] 地底大道旁", 35002951),
    ("[弃置恶兆的地底] 罗德尔地下墓地", 35002953),
    ("[弃置恶兆的地底] 弃置恶兆的大教堂", 35002950),
    ("[弃置恶兆的地底] 弃置恶兆的底层", 35002952),
    ("[弃置恶兆的地底] 癫火封印", 35002954),
    ("[禁域] 东亚坛神授塔（门口）", 34142950),
    ("[禁域] 东亚坛神授塔", 34142951),
    ("[禁域] 禁域", 1047512950),
    ("[禁域] 洛德大升降机", 1049532951),
    ("[禁域] 通往圣树的密道", 30202950),
    ("[巨人山顶] 萨米尔废墟", 1049532950),
    ("[巨人山顶] 古遗迹降雪谷", 1051562950),
    ("[巨人山顶] 结冰湖", 1052572950),
    ("[巨人山顶] 古遗迹山谷的山崖上", 1051572950),
    ("[巨人山顶] 索尔城（正门）", 1051572951),
    ("[巨人山顶] 日蚀教堂", 1051572952),
    ("[巨人山顶] 索尔城（屋顶）", 1051572953),
    ("[巨人山顶] 玛莉卡第一教堂", 1054552950),
    ("[巨人山顶] 降雪棱线路", 1052562950),
    ("[巨人山顶] 唤灵洞窟", 31222950),
    ("[巨人山顶] 巨人山顶地下墓地", 30182950),
    ("[火焰之巅] 巨人墓碑", 1052542950),
    ("[火焰之巅] 安歇教堂", 1051532950),
    ("[火焰之巅] 火焰大锅下方", 1052532950),
    ("[火焰之巅] 火焰巨人", 1053522950),
    ("[火焰之巅] 巨人火焰大锅", 1054532950),
    ("[火焰之巅] 巨人战争的英雄墓地", 30172950),
    ("[蒙格温王朝] 通往王朝的崖上道路", 12052951),
    ("[蒙格温王朝] 王朝庙（入口）", 12052952),
    ("[蒙格温王朝] 王朝庙（中段）", 12052953),
    ("[蒙格温王朝] 神人坠眠之茧", 12052950),
    ("[化圣雪原] 化圣雪原", 1049542950),
    ("[化圣雪原] 化圣雪原（深处）", 1049552950),
    ("[化圣雪原] 离教废屋", 1047582950),
    ("[化圣雪原] “仪典镇”奥缇那", 1048572950),
    ("[化圣雪原] 耶罗·亚尼斯坑道", 32112950),
    ("[化圣雪原] 安身洞窟", 31122950),
    ("[化圣雪原] 化圣雪原地下墓地", 30192950),
    ("[米凯拉的圣树] 圣树树冠", 15002956),
    ("[米凯拉的圣树] 圣树镇", 15002957),
    ("[米凯拉的圣树] 圣树镇（广场）", 15002958),
    ("[米凯拉的圣树] 圣树大舞台", 15002955),
    ("[“圣树分枝”艾布雷菲尔] 祈祷室", 15002951),
    ("[“圣树分枝”艾布雷菲尔] 艾布雷菲尔城墙内部", 15002952),
    ("[“圣树分枝”艾布雷菲尔] 排水通道", 15002953),
    ("[“圣树分枝”艾布雷菲尔] 圣树底层", 15002954),
    ("[“圣树分枝”艾布雷菲尔] “腐败女神”玛莲妮亚", 15002950),
    ("[逐渐崩毁的法姆·亚兹拉] 渐毁野兽墓", 13002953),
    ("[逐渐崩毁的法姆·亚兹拉] 渐毁野兽墓（深处）", 13002954),
    ("[逐渐崩毁的法姆·亚兹拉] 龙教堂", 13002956),
    ("[逐渐崩毁的法姆·亚兹拉] 龙教堂（耳堂）", 13002957),
    ("[逐渐崩毁的法姆·亚兹拉] 龙教堂祭坛", 13002952),
    ("[逐渐崩毁的法姆·亚兹拉] 龙教堂（升降机前）", 13002958),
    ("[逐渐崩毁的法姆·亚兹拉] 龙教堂（屋顶）", 13002959),
    ("[逐渐崩毁的法姆·亚兹拉] 龙卷旁露台", 13002955),
    ("[逐渐崩毁的法姆·亚兹拉] 大桥侧边", 13002960),
    ("[逐渐崩毁的法姆·亚兹拉] “黑剑”玛利喀斯", 13002950),
    ("[逐渐崩毁的法姆·亚兹拉] “龙王”普拉顿桑克斯", 13002951),
    ("[灰城罗德尔] “灰烬王城”罗德尔", 11052953),
    ("[灰城罗德尔] 王城东边城墙", 11052952),
    ("[灰城罗德尔] 黄金树大教堂", 11052951),
    ("[灰城罗德尔] 女王闺阁", 11052954),
    ("[灰城罗德尔] 艾尔登宝座", 11052950),
    ("[灰城罗德尔] 神授桥", 11052955),
    ("[石舞台] 濒毁玛莉卡", 19002950),
];

// type PackCoordsFunc = extern "system" fn(u32, u32, u32, u32);
// type WarpFunc = extern "system" fn(u32, u32);
//
// #[derive(Debug)]
// pub(crate) struct Warp {
//     label: String,
//     pack_coords_func_ptr: usize,
//     warp_func_ptr: usize,
//     hotkey: KeyState,
// }
//
// impl Warp {
//     pub(crate) fn new(pack_coords_func_ptr: usize, warp_func_ptr: usize,
// hotkey: KeyState) -> Self {         Warp { label: format!("Warp"),
// pack_coords_func_ptr, warp_func_ptr, hotkey }     }
//
//     fn warp(&self) {
//         let pack_coords: WarpFunc = unsafe {
// mem::transmute(self.pack_coords_func_ptr) };         let warp: WarpFunc =
// unsafe { mem::transmute(self.warp_func_ptr) };     }
// }
//
// impl Widget for Warp {
//     fn render(&mut self, ui: &imgui::Ui) {
//         let scale = super::scaling_factor(ui);
//
//         if ui.button_with_size(&self.label, [super::BUTTON_WIDTH * scale,
// super::BUTTON_HEIGHT]) {             self.warp();
//         }
//     }
//
//     fn interact(&mut self, ui: &imgui::Ui) {
//         if self.hotkey.keyup(ui) {
//             self.warp();
//         }
//     }
// }
